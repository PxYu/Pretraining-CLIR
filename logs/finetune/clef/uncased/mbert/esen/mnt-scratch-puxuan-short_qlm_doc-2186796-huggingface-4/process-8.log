00:00:06 - Namespace(apex_level='O2', batch_size=8, cased=False, dataset='clef', debug=False, encoder_lr=2e-05, eval_step=1, full_doc_length=True, local_rank=8, model_path='/mnt/scratch/puxuan/short_qlm_doc/2186796/huggingface-4', model_type='mbert', num_epochs=20, num_ft_encoders=3, num_neg=1, projector_lr=2e-05, seed=611, source_lang='es', target_lang='en')
00:00:14 - Evaluating every 1 epochs ...
00:00:14 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:00:15 - test has 35 queries ...
00:00:15 - Data reading done ...
00:00:21 - adding 9-th encoder to optimizer...
00:00:21 - adding 10-th encoder to optimizer...
00:00:21 - adding 11-th encoder to optimizer...
00:00:22 - process[8]: training epoch 0 ...
00:00:34 - process[8] - epoch 0 - train iter 197 - 15346.4 words/s - loss: 0.6867
00:00:34 - process[8]: training epoch 1 ...
00:00:44 - process[8] - epoch 1 - train iter 197 - 17587.9 words/s - loss: 0.6456
00:00:44 - process[8]: training epoch 2 ...
00:00:55 - process[8] - epoch 2 - train iter 197 - 15929.8 words/s - loss: 0.6284
00:00:55 - process[8]: training epoch 3 ...
00:01:06 - process[8] - epoch 3 - train iter 197 - 16293.6 words/s - loss: 0.6247
00:01:06 - process[8]: training epoch 4 ...
00:01:17 - process[8] - epoch 4 - train iter 197 - 15066.5 words/s - loss: 0.5673
00:01:17 - process[8]: training epoch 5 ...
00:01:28 - process[8] - epoch 5 - train iter 197 - 17223.4 words/s - loss: 0.5925
00:01:28 - process[8]: training epoch 6 ...
00:01:39 - process[8] - epoch 6 - train iter 197 - 15377.7 words/s - loss: 0.5668
00:01:39 - process[8]: training epoch 7 ...
00:01:50 - process[8] - epoch 7 - train iter 197 - 17275.9 words/s - loss: 0.5236
00:01:50 - process[8]: training epoch 8 ...
00:02:03 - process[8] - epoch 8 - train iter 197 - 13902.9 words/s - loss: 0.5306
00:02:03 - process[8]: training epoch 9 ...
00:02:14 - process[8] - epoch 9 - train iter 197 - 16271.3 words/s - loss: 0.5260
00:02:14 - process[8]: training epoch 10 ...
00:02:24 - process[8] - epoch 10 - train iter 197 - 17987.5 words/s - loss: 0.5049
00:02:24 - process[8]: evaluating epoch 10 on dev ...
00:03:11 - dev set during evaluation: 14160/14157
00:03:11 - process[8] - dev - epoch 10 - mAP: 0.362 w/ 35 queries
00:03:11 - process[8]: evaluating epoch 10 on test ...
00:03:52 - test set during evaluation: 14980/14975
00:03:52 - process[8] - test - epoch 10 - mAP: 0.366 w/ 35 queries
00:03:52 - process[8]: training epoch 11 ...
00:04:02 - process[8] - epoch 11 - train iter 197 - 17129.2 words/s - loss: 0.4935
00:04:02 - process[8]: evaluating epoch 11 on dev ...
00:04:49 - dev set during evaluation: 14160/14157
00:04:49 - process[8] - dev - epoch 11 - mAP: 0.360 w/ 35 queries
00:04:49 - process[8]: training epoch 12 ...
00:05:01 - process[8] - epoch 12 - train iter 197 - 14639.5 words/s - loss: 0.4409
00:05:01 - process[8]: evaluating epoch 12 on dev ...
00:05:43 - dev set during evaluation: 14160/14157
00:05:43 - process[8] - dev - epoch 12 - mAP: 0.397 w/ 35 queries
00:05:43 - process[8]: evaluating epoch 12 on test ...
00:06:24 - test set during evaluation: 14980/14975
00:06:24 - process[8] - test - epoch 12 - mAP: 0.368 w/ 35 queries
00:06:24 - process[8]: training epoch 13 ...
00:06:35 - process[8] - epoch 13 - train iter 197 - 16899.0 words/s - loss: 0.4701
00:06:35 - process[8]: evaluating epoch 13 on dev ...
00:07:20 - dev set during evaluation: 14160/14157
00:07:20 - process[8] - dev - epoch 13 - mAP: 0.369 w/ 35 queries
00:07:20 - process[8]: training epoch 14 ...
00:07:33 - process[8] - epoch 14 - train iter 197 - 15033.4 words/s - loss: 0.4556
00:07:33 - process[8]: evaluating epoch 14 on dev ...
00:08:16 - dev set during evaluation: 14160/14157
00:08:16 - process[8] - dev - epoch 14 - mAP: 0.383 w/ 35 queries
00:08:16 - process[8]: training epoch 15 ...
00:08:27 - process[8] - epoch 15 - train iter 197 - 16450.9 words/s - loss: 0.4438
00:08:27 - process[8]: evaluating epoch 15 on dev ...
00:09:11 - dev set during evaluation: 14160/14157
00:09:11 - process[8] - dev - epoch 15 - mAP: 0.398 w/ 35 queries
00:09:11 - process[8]: evaluating epoch 15 on test ...
00:09:52 - test set during evaluation: 14980/14975
00:09:52 - process[8] - test - epoch 15 - mAP: 0.383 w/ 35 queries
00:09:52 - process[8]: training epoch 16 ...
00:10:04 - process[8] - epoch 16 - train iter 197 - 15269.3 words/s - loss: 0.4707
00:10:04 - process[8]: evaluating epoch 16 on dev ...
00:10:47 - dev set during evaluation: 14160/14157
00:10:47 - process[8] - dev - epoch 16 - mAP: 0.384 w/ 35 queries
00:10:47 - process[8]: training epoch 17 ...
00:10:58 - process[8] - epoch 17 - train iter 197 - 16672.1 words/s - loss: 0.4815
00:10:58 - process[8]: evaluating epoch 17 on dev ...
00:11:43 - dev set during evaluation: 14160/14157
00:11:43 - process[8] - dev - epoch 17 - mAP: 0.338 w/ 35 queries
00:11:43 - process[8]: training epoch 18 ...
00:11:53 - process[8] - epoch 18 - train iter 197 - 16588.1 words/s - loss: 0.4619
00:11:53 - process[8]: evaluating epoch 18 on dev ...
00:12:37 - dev set during evaluation: 14160/14157
00:12:37 - process[8] - dev - epoch 18 - mAP: 0.351 w/ 35 queries
00:12:37 - process[8]: training epoch 19 ...
00:12:48 - process[8] - epoch 19 - train iter 197 - 16950.1 words/s - loss: 0.4320
00:12:48 - process[8]: evaluating epoch 19 on dev ...
00:13:34 - dev set during evaluation: 14160/14157
00:13:34 - process[8] - dev - epoch 19 - mAP: 0.383 w/ 35 queries
00:13:34 - [fold 1] best test MAP: 0.383 @ epoch 15
00:13:34 - Evaluating every 1 epochs ...
00:13:34 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:13:34 - test has 36 queries ...
00:13:34 - Data reading done ...
00:13:36 - adding 9-th encoder to optimizer...
00:13:36 - adding 10-th encoder to optimizer...
00:13:36 - adding 11-th encoder to optimizer...
00:13:36 - process[8]: training epoch 0 ...
00:13:46 - process[8] - epoch 0 - train iter 187 - 17463.4 words/s - loss: 0.6922
00:13:46 - process[8]: training epoch 1 ...
00:13:56 - process[8] - epoch 1 - train iter 187 - 16721.4 words/s - loss: 0.6788
00:13:56 - process[8]: training epoch 2 ...
00:14:06 - process[8] - epoch 2 - train iter 187 - 17933.9 words/s - loss: 0.6575
00:14:06 - process[8]: training epoch 3 ...
00:14:15 - process[8] - epoch 3 - train iter 187 - 18175.0 words/s - loss: 0.6305
00:14:15 - process[8]: training epoch 4 ...
00:14:25 - process[8] - epoch 4 - train iter 187 - 16916.2 words/s - loss: 0.5909
00:14:25 - process[8]: training epoch 5 ...
00:14:36 - process[8] - epoch 5 - train iter 187 - 16120.3 words/s - loss: 0.5733
00:14:36 - process[8]: training epoch 6 ...
00:14:45 - process[8] - epoch 6 - train iter 187 - 18253.3 words/s - loss: 0.5235
00:14:45 - process[8]: training epoch 7 ...
00:14:55 - process[8] - epoch 7 - train iter 187 - 16704.1 words/s - loss: 0.5149
00:14:55 - process[8]: training epoch 8 ...
00:15:05 - process[8] - epoch 8 - train iter 187 - 17690.5 words/s - loss: 0.5150
00:15:05 - process[8]: training epoch 9 ...
00:15:15 - process[8] - epoch 9 - train iter 187 - 16867.8 words/s - loss: 0.4959
00:15:15 - process[8]: training epoch 10 ...
00:15:26 - process[8] - epoch 10 - train iter 187 - 14849.9 words/s - loss: 0.4828
00:15:26 - process[8]: evaluating epoch 10 on dev ...
00:16:09 - dev set during evaluation: 14980/14975
00:16:09 - process[8] - dev - epoch 10 - mAP: 0.387 w/ 35 queries
00:16:09 - process[8]: evaluating epoch 10 on test ...
00:16:51 - test set during evaluation: 15300/15294
00:16:51 - process[8] - test - epoch 10 - mAP: 0.328 w/ 36 queries
00:16:51 - process[8]: training epoch 11 ...
00:17:01 - process[8] - epoch 11 - train iter 187 - 16719.1 words/s - loss: 0.4658
00:17:01 - process[8]: evaluating epoch 11 on dev ...
00:17:42 - dev set during evaluation: 14980/14975
00:17:43 - process[8] - dev - epoch 11 - mAP: 0.292 w/ 35 queries
00:17:43 - process[8]: training epoch 12 ...
00:17:53 - process[8] - epoch 12 - train iter 187 - 16283.1 words/s - loss: 0.4907
00:17:53 - process[8]: evaluating epoch 12 on dev ...
00:18:34 - dev set during evaluation: 14980/14975
00:18:34 - process[8] - dev - epoch 12 - mAP: 0.295 w/ 35 queries
00:18:34 - process[8]: training epoch 13 ...
00:18:44 - process[8] - epoch 13 - train iter 187 - 16515.5 words/s - loss: 0.4624
00:18:44 - process[8]: evaluating epoch 13 on dev ...
00:19:25 - dev set during evaluation: 14980/14975
00:19:25 - process[8] - dev - epoch 13 - mAP: 0.356 w/ 35 queries
00:19:25 - process[8]: training epoch 14 ...
00:19:35 - process[8] - epoch 14 - train iter 187 - 16244.7 words/s - loss: 0.4798
00:19:35 - process[8]: evaluating epoch 14 on dev ...
00:20:16 - dev set during evaluation: 14980/14975
00:20:16 - process[8] - dev - epoch 14 - mAP: 0.311 w/ 35 queries
00:20:16 - process[8]: training epoch 15 ...
00:20:26 - process[8] - epoch 15 - train iter 187 - 17421.5 words/s - loss: 0.4742
00:20:26 - process[8]: evaluating epoch 15 on dev ...
00:21:07 - dev set during evaluation: 14980/14975
00:21:07 - process[8] - dev - epoch 15 - mAP: 0.327 w/ 35 queries
00:21:07 - process[8]: training epoch 16 ...
00:21:18 - process[8] - epoch 16 - train iter 187 - 16490.3 words/s - loss: 0.4326
00:21:18 - process[8]: evaluating epoch 16 on dev ...
00:22:02 - dev set during evaluation: 14980/14975
00:22:02 - process[8] - dev - epoch 16 - mAP: 0.330 w/ 35 queries
00:22:02 - process[8]: training epoch 17 ...
00:22:11 - process[8] - epoch 17 - train iter 187 - 17310.2 words/s - loss: 0.3802
00:22:11 - process[8]: evaluating epoch 17 on dev ...
00:22:52 - dev set during evaluation: 14980/14975
00:22:52 - process[8] - dev - epoch 17 - mAP: 0.367 w/ 35 queries
00:22:52 - process[8]: training epoch 18 ...
00:23:03 - process[8] - epoch 18 - train iter 187 - 15407.9 words/s - loss: 0.4254
00:23:03 - process[8]: evaluating epoch 18 on dev ...
00:23:44 - dev set during evaluation: 14980/14975
00:23:44 - process[8] - dev - epoch 18 - mAP: 0.375 w/ 35 queries
00:23:44 - process[8]: training epoch 19 ...
00:23:53 - process[8] - epoch 19 - train iter 187 - 18096.8 words/s - loss: 0.4472
00:23:53 - process[8]: evaluating epoch 19 on dev ...
00:24:35 - dev set during evaluation: 14980/14975
00:24:35 - process[8] - dev - epoch 19 - mAP: 0.374 w/ 35 queries
00:24:35 - [fold 2] best test MAP: 0.328 @ epoch 10
00:24:35 - Evaluating every 1 epochs ...
00:24:35 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:24:35 - test has 35 queries ...
00:24:35 - Data reading done ...
00:24:37 - adding 9-th encoder to optimizer...
00:24:37 - adding 10-th encoder to optimizer...
00:24:37 - adding 11-th encoder to optimizer...
00:24:37 - process[8]: training epoch 0 ...
00:24:48 - process[8] - epoch 0 - train iter 196 - 16273.3 words/s - loss: 0.6813
00:24:48 - process[8]: training epoch 1 ...
00:24:59 - process[8] - epoch 1 - train iter 196 - 15987.4 words/s - loss: 0.6622
00:24:59 - process[8]: training epoch 2 ...
00:25:09 - process[8] - epoch 2 - train iter 196 - 17680.5 words/s - loss: 0.6284
00:25:09 - process[8]: training epoch 3 ...
00:25:18 - process[8] - epoch 3 - train iter 196 - 19125.0 words/s - loss: 0.5986
00:25:18 - process[8]: training epoch 4 ...
00:25:29 - process[8] - epoch 4 - train iter 196 - 15878.2 words/s - loss: 0.5833
00:25:29 - process[8]: training epoch 5 ...
00:25:40 - process[8] - epoch 5 - train iter 196 - 16959.9 words/s - loss: 0.5662
00:25:40 - process[8]: training epoch 6 ...
00:25:51 - process[8] - epoch 6 - train iter 196 - 15958.5 words/s - loss: 0.6012
00:25:51 - process[8]: training epoch 7 ...
00:26:01 - process[8] - epoch 7 - train iter 196 - 17333.2 words/s - loss: 0.5590
00:26:01 - process[8]: training epoch 8 ...
00:26:11 - process[8] - epoch 8 - train iter 196 - 17236.7 words/s - loss: 0.5273
00:26:11 - process[8]: training epoch 9 ...
00:26:22 - process[8] - epoch 9 - train iter 196 - 16386.4 words/s - loss: 0.5556
00:26:22 - process[8]: training epoch 10 ...
00:26:33 - process[8] - epoch 10 - train iter 196 - 16467.5 words/s - loss: 0.5203
00:26:33 - process[8]: evaluating epoch 10 on dev ...
00:27:18 - dev set during evaluation: 15300/15294
00:27:18 - process[8] - dev - epoch 10 - mAP: 0.273 w/ 36 queries
00:27:18 - process[8]: evaluating epoch 10 on test ...
00:28:00 - test set during evaluation: 15480/15477
00:28:00 - process[8] - test - epoch 10 - mAP: 0.274 w/ 35 queries
00:28:00 - process[8]: training epoch 11 ...
00:28:11 - process[8] - epoch 11 - train iter 196 - 16545.0 words/s - loss: 0.5022
00:28:11 - process[8]: evaluating epoch 11 on dev ...
00:28:53 - dev set during evaluation: 15300/15294
00:28:53 - process[8] - dev - epoch 11 - mAP: 0.298 w/ 36 queries
00:28:53 - process[8]: evaluating epoch 11 on test ...
00:29:35 - test set during evaluation: 15480/15477
00:29:35 - process[8] - test - epoch 11 - mAP: 0.297 w/ 35 queries
00:29:35 - process[8]: training epoch 12 ...
00:29:47 - process[8] - epoch 12 - train iter 196 - 15733.3 words/s - loss: 0.5203
00:29:47 - process[8]: evaluating epoch 12 on dev ...
00:30:28 - dev set during evaluation: 15300/15294
00:30:28 - process[8] - dev - epoch 12 - mAP: 0.309 w/ 36 queries
00:30:28 - process[8]: evaluating epoch 12 on test ...
00:31:10 - test set during evaluation: 15480/15477
00:31:11 - process[8] - test - epoch 12 - mAP: 0.307 w/ 35 queries
00:31:11 - process[8]: training epoch 13 ...
00:31:20 - process[8] - epoch 13 - train iter 196 - 19008.5 words/s - loss: 0.4997
00:31:20 - process[8]: evaluating epoch 13 on dev ...
00:32:04 - dev set during evaluation: 15300/15294
00:32:04 - process[8] - dev - epoch 13 - mAP: 0.331 w/ 36 queries
00:32:04 - process[8]: evaluating epoch 13 on test ...
00:32:50 - test set during evaluation: 15480/15477
00:32:50 - process[8] - test - epoch 13 - mAP: 0.327 w/ 35 queries
00:32:50 - process[8]: training epoch 14 ...
00:33:00 - process[8] - epoch 14 - train iter 196 - 17894.5 words/s - loss: 0.4849
00:33:00 - process[8]: evaluating epoch 14 on dev ...
00:33:43 - dev set during evaluation: 15300/15294
00:33:43 - process[8] - dev - epoch 14 - mAP: 0.331 w/ 36 queries
00:33:43 - process[8]: evaluating epoch 14 on test ...
00:34:25 - test set during evaluation: 15480/15477
00:34:25 - process[8] - test - epoch 14 - mAP: 0.302 w/ 35 queries
00:34:25 - process[8]: training epoch 15 ...
00:34:35 - process[8] - epoch 15 - train iter 196 - 17612.2 words/s - loss: 0.4450
00:34:35 - process[8]: evaluating epoch 15 on dev ...
00:35:17 - dev set during evaluation: 15300/15294
00:35:17 - process[8] - dev - epoch 15 - mAP: 0.301 w/ 36 queries
00:35:17 - process[8]: training epoch 16 ...
00:35:28 - process[8] - epoch 16 - train iter 196 - 16221.7 words/s - loss: 0.4322
00:35:28 - process[8]: evaluating epoch 16 on dev ...
00:36:10 - dev set during evaluation: 15300/15294
00:36:10 - process[8] - dev - epoch 16 - mAP: 0.315 w/ 36 queries
00:36:10 - process[8]: training epoch 17 ...
00:36:19 - process[8] - epoch 17 - train iter 196 - 18938.9 words/s - loss: 0.4877
00:36:19 - process[8]: evaluating epoch 17 on dev ...
00:37:02 - dev set during evaluation: 15300/15294
00:37:02 - process[8] - dev - epoch 17 - mAP: 0.388 w/ 36 queries
00:37:02 - process[8]: evaluating epoch 17 on test ...
00:37:44 - test set during evaluation: 15480/15477
00:37:44 - process[8] - test - epoch 17 - mAP: 0.336 w/ 35 queries
00:37:44 - process[8]: training epoch 18 ...
00:37:54 - process[8] - epoch 18 - train iter 196 - 17967.3 words/s - loss: 0.4855
00:37:54 - process[8]: evaluating epoch 18 on dev ...
00:38:37 - dev set during evaluation: 15300/15294
00:38:37 - process[8] - dev - epoch 18 - mAP: 0.342 w/ 36 queries
00:38:37 - process[8]: training epoch 19 ...
00:38:48 - process[8] - epoch 19 - train iter 196 - 17892.1 words/s - loss: 0.4728
00:38:48 - process[8]: evaluating epoch 19 on dev ...
00:39:31 - dev set during evaluation: 15300/15294
00:39:31 - process[8] - dev - epoch 19 - mAP: 0.336 w/ 36 queries
00:39:31 - [fold 3] best test MAP: 0.336 @ epoch 17
00:39:31 - Evaluating every 1 epochs ...
00:39:31 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:39:32 - test has 35 queries ...
00:39:32 - Data reading done ...
00:39:34 - adding 9-th encoder to optimizer...
00:39:34 - adding 10-th encoder to optimizer...
00:39:34 - adding 11-th encoder to optimizer...
00:39:34 - process[8]: training epoch 0 ...
00:39:46 - process[8] - epoch 0 - train iter 207 - 16389.7 words/s - loss: 0.6829
00:39:46 - process[8]: training epoch 1 ...
00:39:56 - process[8] - epoch 1 - train iter 207 - 17665.8 words/s - loss: 0.6545
00:39:56 - process[8]: training epoch 2 ...
00:40:07 - process[8] - epoch 2 - train iter 207 - 16956.6 words/s - loss: 0.6282
00:40:07 - process[8]: training epoch 3 ...
00:40:20 - process[8] - epoch 3 - train iter 207 - 14476.2 words/s - loss: 0.6032
00:40:20 - process[8]: training epoch 4 ...
00:40:33 - process[8] - epoch 4 - train iter 207 - 15517.7 words/s - loss: 0.5768
00:40:33 - process[8]: training epoch 5 ...
00:40:43 - process[8] - epoch 5 - train iter 207 - 17943.4 words/s - loss: 0.5451
00:40:45 - process[8]: training epoch 6 ...
00:40:56 - process[8] - epoch 6 - train iter 207 - 16891.3 words/s - loss: 0.5369
00:40:56 - process[8]: training epoch 7 ...
00:41:06 - process[8] - epoch 7 - train iter 207 - 18520.3 words/s - loss: 0.5077
00:41:06 - process[8]: training epoch 8 ...
00:41:17 - process[8] - epoch 8 - train iter 207 - 16913.3 words/s - loss: 0.4865
00:41:17 - process[8]: training epoch 9 ...
00:41:28 - process[8] - epoch 9 - train iter 207 - 17017.8 words/s - loss: 0.4984
00:41:28 - process[8]: training epoch 10 ...
00:41:40 - process[8] - epoch 10 - train iter 207 - 16292.1 words/s - loss: 0.5169
00:41:40 - process[8]: evaluating epoch 10 on dev ...
00:42:23 - dev set during evaluation: 15480/15477
00:42:23 - process[8] - dev - epoch 10 - mAP: 0.290 w/ 35 queries
00:42:23 - process[8]: evaluating epoch 10 on test ...
00:43:05 - test set during evaluation: 14470/14463
00:43:05 - process[8] - test - epoch 10 - mAP: 0.263 w/ 35 queries
00:43:05 - process[8]: training epoch 11 ...
00:43:16 - process[8] - epoch 11 - train iter 207 - 18083.8 words/s - loss: 0.4957
00:43:16 - process[8]: evaluating epoch 11 on dev ...
00:43:58 - dev set during evaluation: 15480/15477
00:43:58 - process[8] - dev - epoch 11 - mAP: 0.291 w/ 35 queries
00:43:58 - process[8]: evaluating epoch 11 on test ...
00:44:40 - test set during evaluation: 14470/14463
00:44:40 - process[8] - test - epoch 11 - mAP: 0.292 w/ 35 queries
00:44:40 - process[8]: training epoch 12 ...
00:44:52 - process[8] - epoch 12 - train iter 207 - 15756.0 words/s - loss: 0.4615
00:44:52 - process[8]: evaluating epoch 12 on dev ...
00:45:34 - dev set during evaluation: 15480/15477
00:45:34 - process[8] - dev - epoch 12 - mAP: 0.265 w/ 35 queries
00:45:34 - process[8]: training epoch 13 ...
00:45:45 - process[8] - epoch 13 - train iter 207 - 16544.9 words/s - loss: 0.4620
00:45:45 - process[8]: evaluating epoch 13 on dev ...
00:46:27 - dev set during evaluation: 15480/15477
00:46:27 - process[8] - dev - epoch 13 - mAP: 0.281 w/ 35 queries
00:46:27 - process[8]: training epoch 14 ...
00:46:38 - process[8] - epoch 14 - train iter 207 - 17200.3 words/s - loss: 0.4511
00:46:38 - process[8]: evaluating epoch 14 on dev ...
00:47:21 - dev set during evaluation: 15480/15477
00:47:21 - process[8] - dev - epoch 14 - mAP: 0.293 w/ 35 queries
00:47:21 - process[8]: evaluating epoch 14 on test ...
00:48:03 - test set during evaluation: 14470/14463
00:48:03 - process[8] - test - epoch 14 - mAP: 0.314 w/ 35 queries
00:48:03 - process[8]: training epoch 15 ...
00:48:14 - process[8] - epoch 15 - train iter 207 - 16896.6 words/s - loss: 0.4260
00:48:14 - process[8]: evaluating epoch 15 on dev ...
00:48:55 - dev set during evaluation: 15480/15477
00:48:55 - process[8] - dev - epoch 15 - mAP: 0.280 w/ 35 queries
00:48:55 - process[8]: training epoch 16 ...
00:49:07 - process[8] - epoch 16 - train iter 207 - 15732.4 words/s - loss: 0.4368
00:49:07 - process[8]: evaluating epoch 16 on dev ...
00:49:49 - dev set during evaluation: 15480/15477
00:49:49 - process[8] - dev - epoch 16 - mAP: 0.283 w/ 35 queries
00:49:49 - process[8]: training epoch 17 ...
00:50:01 - process[8] - epoch 17 - train iter 207 - 15830.8 words/s - loss: 0.4059
00:50:01 - process[8]: evaluating epoch 17 on dev ...
00:50:43 - dev set during evaluation: 15480/15477
00:50:43 - process[8] - dev - epoch 17 - mAP: 0.331 w/ 35 queries
00:50:43 - process[8]: evaluating epoch 17 on test ...
00:51:25 - test set during evaluation: 14470/14463
00:51:25 - process[8] - test - epoch 17 - mAP: 0.323 w/ 35 queries
00:51:25 - process[8]: training epoch 18 ...
00:51:36 - process[8] - epoch 18 - train iter 207 - 17258.4 words/s - loss: 0.4747
00:51:36 - process[8]: evaluating epoch 18 on dev ...
00:52:18 - dev set during evaluation: 15480/15477
00:52:18 - process[8] - dev - epoch 18 - mAP: 0.323 w/ 35 queries
00:52:18 - process[8]: training epoch 19 ...
00:52:28 - process[8] - epoch 19 - train iter 207 - 18729.8 words/s - loss: 0.4314
00:52:28 - process[8]: evaluating epoch 19 on dev ...
00:53:12 - dev set during evaluation: 15480/15477
00:53:12 - process[8] - dev - epoch 19 - mAP: 0.312 w/ 35 queries
00:53:12 - [fold 4] best test MAP: 0.323 @ epoch 17
00:53:12 - Evaluating every 1 epochs ...
00:53:12 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:53:12 - test has 35 queries ...
00:53:12 - Data reading done ...
00:53:14 - adding 9-th encoder to optimizer...
00:53:14 - adding 10-th encoder to optimizer...
00:53:14 - adding 11-th encoder to optimizer...
00:53:14 - process[8]: training epoch 0 ...
00:53:26 - process[8] - epoch 0 - train iter 195 - 15835.9 words/s - loss: 0.6837
00:53:26 - process[8]: training epoch 1 ...
00:53:37 - process[8] - epoch 1 - train iter 195 - 15091.0 words/s - loss: 0.6436
00:53:37 - process[8]: training epoch 2 ...
00:53:49 - process[8] - epoch 2 - train iter 195 - 15588.0 words/s - loss: 0.5846
00:53:49 - process[8]: training epoch 3 ...
00:54:00 - process[8] - epoch 3 - train iter 195 - 15517.4 words/s - loss: 0.5962
00:54:00 - process[8]: training epoch 4 ...
00:54:11 - process[8] - epoch 4 - train iter 195 - 15216.6 words/s - loss: 0.5719
00:54:11 - process[8]: training epoch 5 ...
00:54:24 - process[8] - epoch 5 - train iter 195 - 14331.1 words/s - loss: 0.5173
00:54:24 - process[8]: training epoch 6 ...
00:54:35 - process[8] - epoch 6 - train iter 195 - 15637.8 words/s - loss: 0.5021
00:54:35 - process[8]: training epoch 7 ...
00:54:46 - process[8] - epoch 7 - train iter 195 - 15826.2 words/s - loss: 0.5093
00:54:46 - process[8]: training epoch 8 ...
00:54:57 - process[8] - epoch 8 - train iter 195 - 15224.2 words/s - loss: 0.4485
00:54:57 - process[8]: training epoch 9 ...
00:55:07 - process[8] - epoch 9 - train iter 195 - 17978.2 words/s - loss: 0.4883
00:55:07 - process[8]: training epoch 10 ...
00:55:18 - process[8] - epoch 10 - train iter 195 - 15668.8 words/s - loss: 0.4746
00:55:18 - process[8]: evaluating epoch 10 on dev ...
00:55:58 - dev set during evaluation: 14470/14463
00:55:58 - process[8] - dev - epoch 10 - mAP: 0.295 w/ 35 queries
00:55:58 - process[8]: evaluating epoch 10 on test ...
00:56:43 - test set during evaluation: 14160/14157
00:56:43 - process[8] - test - epoch 10 - mAP: 0.323 w/ 35 queries
00:56:43 - process[8]: training epoch 11 ...
00:56:54 - process[8] - epoch 11 - train iter 195 - 16397.2 words/s - loss: 0.4781
00:56:54 - process[8]: evaluating epoch 11 on dev ...
00:57:37 - dev set during evaluation: 14470/14463
00:57:37 - process[8] - dev - epoch 11 - mAP: 0.285 w/ 35 queries
00:57:37 - process[8]: training epoch 12 ...
00:57:48 - process[8] - epoch 12 - train iter 195 - 16039.3 words/s - loss: 0.4227
00:57:48 - process[8]: evaluating epoch 12 on dev ...
00:58:30 - dev set during evaluation: 14470/14463
00:58:30 - process[8] - dev - epoch 12 - mAP: 0.318 w/ 35 queries
00:58:30 - process[8]: evaluating epoch 12 on test ...
00:59:15 - test set during evaluation: 14160/14157
00:59:15 - process[8] - test - epoch 12 - mAP: 0.351 w/ 35 queries
00:59:15 - process[8]: training epoch 13 ...
00:59:26 - process[8] - epoch 13 - train iter 195 - 15983.4 words/s - loss: 0.4677
00:59:26 - process[8]: evaluating epoch 13 on dev ...
01:00:08 - dev set during evaluation: 14470/14463
01:00:08 - process[8] - dev - epoch 13 - mAP: 0.336 w/ 35 queries
01:00:08 - process[8]: evaluating epoch 13 on test ...
01:00:53 - test set during evaluation: 14160/14157
01:00:53 - process[8] - test - epoch 13 - mAP: 0.359 w/ 35 queries
01:00:53 - process[8]: training epoch 14 ...
01:01:04 - process[8] - epoch 14 - train iter 195 - 15541.9 words/s - loss: 0.4661
01:01:04 - process[8]: evaluating epoch 14 on dev ...
01:01:46 - dev set during evaluation: 14470/14463
01:01:47 - process[8] - dev - epoch 14 - mAP: 0.339 w/ 35 queries
01:01:47 - process[8]: evaluating epoch 14 on test ...
01:02:32 - test set during evaluation: 14160/14157
01:02:32 - process[8] - test - epoch 14 - mAP: 0.342 w/ 35 queries
01:02:32 - process[8]: training epoch 15 ...
01:02:42 - process[8] - epoch 15 - train iter 195 - 16463.0 words/s - loss: 0.4214
01:02:42 - process[8]: evaluating epoch 15 on dev ...
01:03:24 - dev set during evaluation: 14470/14463
01:03:24 - process[8] - dev - epoch 15 - mAP: 0.311 w/ 35 queries
01:03:24 - process[8]: training epoch 16 ...
01:03:34 - process[8] - epoch 16 - train iter 195 - 16109.6 words/s - loss: 0.4574
01:03:34 - process[8]: evaluating epoch 16 on dev ...
01:04:17 - dev set during evaluation: 14470/14463
01:04:17 - process[8] - dev - epoch 16 - mAP: 0.296 w/ 35 queries
01:04:17 - process[8]: training epoch 17 ...
01:04:27 - process[8] - epoch 17 - train iter 195 - 16811.9 words/s - loss: 0.3860
01:04:27 - process[8]: evaluating epoch 17 on dev ...
01:05:11 - dev set during evaluation: 14470/14463
01:05:11 - process[8] - dev - epoch 17 - mAP: 0.342 w/ 35 queries
01:05:11 - process[8]: evaluating epoch 17 on test ...
01:05:56 - test set during evaluation: 14160/14157
01:05:56 - process[8] - test - epoch 17 - mAP: 0.352 w/ 35 queries
01:05:56 - process[8]: training epoch 18 ...
01:06:08 - process[8] - epoch 18 - train iter 195 - 14478.0 words/s - loss: 0.4231
01:06:08 - process[8]: evaluating epoch 18 on dev ...
01:06:48 - dev set during evaluation: 14470/14463
01:06:48 - process[8] - dev - epoch 18 - mAP: 0.348 w/ 35 queries
01:06:48 - process[8]: evaluating epoch 18 on test ...
01:07:33 - test set during evaluation: 14160/14157
01:07:33 - process[8] - test - epoch 18 - mAP: 0.348 w/ 35 queries
01:07:33 - process[8]: training epoch 19 ...
01:07:43 - process[8] - epoch 19 - train iter 195 - 18097.1 words/s - loss: 0.4116
01:07:43 - process[8]: evaluating epoch 19 on dev ...
01:08:25 - dev set during evaluation: 14470/14463
01:08:25 - process[8] - dev - epoch 19 - mAP: 0.306 w/ 35 queries
01:08:26 - [fold 5] best test MAP: 0.348 @ epoch 18
01:08:26 - [0.3827829013885834, 0.3277149519253127, 0.33600581380736017, 0.3231640701663685, 0.34844428784499326]
01:08:26 - [35, 36, 35, 35, 35]
01:08:26 - final MAP: 0.344
00:00:04 - Namespace(apex_level='O2', batch_size=8, cased=False, dataset='clef', debug=False, encoder_lr=2e-05, eval_step=1, full_doc_length=True, local_rank=8, model_path='/mnt/scratch/puxuan/short_qlm_doc/2186796/huggingface-4', model_type='mbert', num_epochs=20, num_ft_encoders=3, num_neg=1, projector_lr=2e-05, seed=611, source_lang='es', target_lang='en')
00:00:13 - Evaluating every 1 epochs ...
00:00:13 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:00:14 - test has 35 queries ...
00:00:14 - Data reading done ...
00:00:21 - adding 9-th encoder to optimizer...
00:00:21 - adding 10-th encoder to optimizer...
00:00:21 - adding 11-th encoder to optimizer...
00:00:22 - process[8]: training epoch 0 ...
00:00:34 - process[8] - epoch 0 - train iter 197 - 15112.8 words/s - loss: 0.6867
00:00:34 - process[8]: training epoch 1 ...
00:00:44 - process[8] - epoch 1 - train iter 197 - 17834.2 words/s - loss: 0.6456
00:00:44 - process[8]: training epoch 2 ...
00:00:55 - process[8] - epoch 2 - train iter 197 - 16103.4 words/s - loss: 0.6284
00:00:55 - process[8]: training epoch 3 ...
00:01:05 - process[8] - epoch 3 - train iter 197 - 16539.4 words/s - loss: 0.6247
00:01:05 - process[8]: training epoch 4 ...
00:01:17 - process[8] - epoch 4 - train iter 197 - 15237.0 words/s - loss: 0.5673
00:01:17 - process[8]: training epoch 5 ...
00:01:27 - process[8] - epoch 5 - train iter 197 - 17474.4 words/s - loss: 0.5925
00:01:27 - process[8]: training epoch 6 ...
00:01:39 - process[8] - epoch 6 - train iter 197 - 15583.2 words/s - loss: 0.5668
00:01:39 - process[8]: training epoch 7 ...
00:01:49 - process[8] - epoch 7 - train iter 197 - 17508.1 words/s - loss: 0.5236
00:01:49 - process[8]: training epoch 8 ...
00:02:02 - process[8] - epoch 8 - train iter 197 - 14098.8 words/s - loss: 0.5306
00:02:02 - process[8]: training epoch 9 ...
00:02:13 - process[8] - epoch 9 - train iter 197 - 16498.1 words/s - loss: 0.5260
00:02:13 - process[8]: training epoch 10 ...
00:02:22 - process[8] - epoch 10 - train iter 197 - 18204.7 words/s - loss: 0.5049
00:02:22 - process[8]: evaluating epoch 10 on dev ...
00:03:14 - dev set during evaluation: 14160/14157
00:03:14 - process[8] - dev - epoch 10 - mAP: 0.362 w/ 35 queries
00:03:14 - process[8]: evaluating epoch 10 on test ...
00:03:55 - test set during evaluation: 14980/14975
00:03:55 - process[8] - test - epoch 10 - mAP: 0.366 w/ 35 queries
00:03:55 - process[8]: training epoch 11 ...
00:04:06 - process[8] - epoch 11 - train iter 197 - 17363.4 words/s - loss: 0.4935
00:04:06 - process[8]: evaluating epoch 11 on dev ...
00:04:53 - dev set during evaluation: 14160/14157
00:04:53 - process[8] - dev - epoch 11 - mAP: 0.360 w/ 35 queries
00:04:53 - process[8]: training epoch 12 ...
00:05:05 - process[8] - epoch 12 - train iter 197 - 14684.9 words/s - loss: 0.4409
00:05:05 - process[8]: evaluating epoch 12 on dev ...
00:05:48 - dev set during evaluation: 14160/14157
00:05:48 - process[8] - dev - epoch 12 - mAP: 0.397 w/ 35 queries
00:05:48 - process[8]: evaluating epoch 12 on test ...
00:06:29 - test set during evaluation: 14980/14975
00:06:29 - process[8] - test - epoch 12 - mAP: 0.368 w/ 35 queries
00:06:29 - process[8]: training epoch 13 ...
00:06:40 - process[8] - epoch 13 - train iter 197 - 16973.5 words/s - loss: 0.4701
00:06:40 - process[8]: evaluating epoch 13 on dev ...
00:07:26 - dev set during evaluation: 14160/14157
00:07:26 - process[8] - dev - epoch 13 - mAP: 0.369 w/ 35 queries
00:07:26 - process[8]: training epoch 14 ...
00:07:38 - process[8] - epoch 14 - train iter 197 - 15189.0 words/s - loss: 0.4556
00:07:38 - process[8]: evaluating epoch 14 on dev ...
00:08:23 - dev set during evaluation: 14160/14157
00:08:23 - process[8] - dev - epoch 14 - mAP: 0.383 w/ 35 queries
00:08:23 - process[8]: training epoch 15 ...
00:08:34 - process[8] - epoch 15 - train iter 197 - 16716.6 words/s - loss: 0.4438
00:08:34 - process[8]: evaluating epoch 15 on dev ...
00:09:19 - dev set during evaluation: 14160/14157
00:09:19 - process[8] - dev - epoch 15 - mAP: 0.398 w/ 35 queries
00:09:19 - process[8]: evaluating epoch 15 on test ...
00:10:01 - test set during evaluation: 14980/14975
00:10:01 - process[8] - test - epoch 15 - mAP: 0.383 w/ 35 queries
00:10:01 - process[8]: training epoch 16 ...
00:10:13 - process[8] - epoch 16 - train iter 197 - 15463.4 words/s - loss: 0.4707
00:10:13 - process[8]: evaluating epoch 16 on dev ...
00:10:57 - dev set during evaluation: 14160/14157
00:10:57 - process[8] - dev - epoch 16 - mAP: 0.384 w/ 35 queries
00:10:57 - process[8]: training epoch 17 ...
00:11:08 - process[8] - epoch 17 - train iter 197 - 16887.5 words/s - loss: 0.4815
00:11:08 - process[8]: evaluating epoch 17 on dev ...
00:11:53 - dev set during evaluation: 14160/14157
00:11:54 - process[8] - dev - epoch 17 - mAP: 0.338 w/ 35 queries
00:11:54 - process[8]: training epoch 18 ...
00:12:04 - process[8] - epoch 18 - train iter 197 - 16804.9 words/s - loss: 0.4619
00:12:04 - process[8]: evaluating epoch 18 on dev ...
00:12:49 - dev set during evaluation: 14160/14157
00:12:49 - process[8] - dev - epoch 18 - mAP: 0.351 w/ 35 queries
00:12:49 - process[8]: training epoch 19 ...
00:12:59 - process[8] - epoch 19 - train iter 197 - 17169.9 words/s - loss: 0.4320
00:12:59 - process[8]: evaluating epoch 19 on dev ...
00:13:46 - dev set during evaluation: 14160/14157
00:13:46 - process[8] - dev - epoch 19 - mAP: 0.383 w/ 35 queries
00:13:46 - [fold 1] best test MAP: 0.383 @ epoch 15
00:13:46 - Evaluating every 1 epochs ...
00:13:46 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:13:46 - test has 36 queries ...
00:13:46 - Data reading done ...
00:13:48 - adding 9-th encoder to optimizer...
00:13:48 - adding 10-th encoder to optimizer...
00:13:48 - adding 11-th encoder to optimizer...
00:13:49 - process[8]: training epoch 0 ...
00:13:58 - process[8] - epoch 0 - train iter 187 - 17751.0 words/s - loss: 0.6922
00:13:58 - process[8]: training epoch 1 ...
00:14:08 - process[8] - epoch 1 - train iter 187 - 16951.3 words/s - loss: 0.6788
00:14:08 - process[8]: training epoch 2 ...
00:14:17 - process[8] - epoch 2 - train iter 187 - 18095.2 words/s - loss: 0.6575
00:14:17 - process[8]: training epoch 3 ...
00:14:27 - process[8] - epoch 3 - train iter 187 - 18328.4 words/s - loss: 0.6305
00:14:27 - process[8]: training epoch 4 ...
00:14:37 - process[8] - epoch 4 - train iter 187 - 17093.3 words/s - loss: 0.5909
00:14:37 - process[8]: training epoch 5 ...
00:14:47 - process[8] - epoch 5 - train iter 187 - 16259.3 words/s - loss: 0.5733
00:14:47 - process[8]: training epoch 6 ...
00:14:57 - process[8] - epoch 6 - train iter 187 - 18427.1 words/s - loss: 0.5235
00:14:57 - process[8]: training epoch 7 ...
00:15:07 - process[8] - epoch 7 - train iter 187 - 16842.5 words/s - loss: 0.5149
00:15:07 - process[8]: training epoch 8 ...
00:15:16 - process[8] - epoch 8 - train iter 187 - 17824.9 words/s - loss: 0.5150
00:15:16 - process[8]: training epoch 9 ...
00:15:26 - process[8] - epoch 9 - train iter 187 - 17067.1 words/s - loss: 0.4959
00:15:26 - process[8]: training epoch 10 ...
00:15:37 - process[8] - epoch 10 - train iter 187 - 14974.8 words/s - loss: 0.4828
00:15:37 - process[8]: evaluating epoch 10 on dev ...
00:16:22 - dev set during evaluation: 14980/14975
00:16:22 - process[8] - dev - epoch 10 - mAP: 0.387 w/ 35 queries
00:16:22 - process[8]: evaluating epoch 10 on test ...
00:17:06 - test set during evaluation: 15300/15294
00:17:06 - process[8] - test - epoch 10 - mAP: 0.328 w/ 36 queries
00:17:06 - process[8]: training epoch 11 ...
00:17:16 - process[8] - epoch 11 - train iter 187 - 16826.3 words/s - loss: 0.4658
00:17:16 - process[8]: evaluating epoch 11 on dev ...
00:17:57 - dev set during evaluation: 14980/14975
00:17:57 - process[8] - dev - epoch 11 - mAP: 0.292 w/ 35 queries
00:17:57 - process[8]: training epoch 12 ...
00:18:07 - process[8] - epoch 12 - train iter 187 - 16474.7 words/s - loss: 0.4907
00:18:07 - process[8]: evaluating epoch 12 on dev ...
00:18:49 - dev set during evaluation: 14980/14975
00:18:49 - process[8] - dev - epoch 12 - mAP: 0.295 w/ 35 queries
00:18:49 - process[8]: training epoch 13 ...
00:18:59 - process[8] - epoch 13 - train iter 187 - 16790.5 words/s - loss: 0.4624
00:18:59 - process[8]: evaluating epoch 13 on dev ...
00:19:41 - dev set during evaluation: 14980/14975
00:19:41 - process[8] - dev - epoch 13 - mAP: 0.356 w/ 35 queries
00:19:41 - process[8]: training epoch 14 ...
00:19:51 - process[8] - epoch 14 - train iter 187 - 16340.6 words/s - loss: 0.4798
00:19:51 - process[8]: evaluating epoch 14 on dev ...
00:20:32 - dev set during evaluation: 14980/14975
00:20:32 - process[8] - dev - epoch 14 - mAP: 0.311 w/ 35 queries
00:20:32 - process[8]: training epoch 15 ...
00:20:42 - process[8] - epoch 15 - train iter 187 - 17470.4 words/s - loss: 0.4742
00:20:42 - process[8]: evaluating epoch 15 on dev ...
00:21:23 - dev set during evaluation: 14980/14975
00:21:23 - process[8] - dev - epoch 15 - mAP: 0.327 w/ 35 queries
00:21:23 - process[8]: training epoch 16 ...
00:21:34 - process[8] - epoch 16 - train iter 187 - 16516.8 words/s - loss: 0.4326
00:21:34 - process[8]: evaluating epoch 16 on dev ...
00:22:14 - dev set during evaluation: 14980/14975
00:22:14 - process[8] - dev - epoch 16 - mAP: 0.330 w/ 35 queries
00:22:14 - process[8]: training epoch 17 ...
00:22:24 - process[8] - epoch 17 - train iter 187 - 17502.2 words/s - loss: 0.3802
00:22:24 - process[8]: evaluating epoch 17 on dev ...
00:23:05 - dev set during evaluation: 14980/14975
00:23:05 - process[8] - dev - epoch 17 - mAP: 0.367 w/ 35 queries
00:23:05 - process[8]: training epoch 18 ...
00:23:16 - process[8] - epoch 18 - train iter 187 - 15543.1 words/s - loss: 0.4254
00:23:16 - process[8]: evaluating epoch 18 on dev ...
00:23:56 - dev set during evaluation: 14980/14975
00:23:56 - process[8] - dev - epoch 18 - mAP: 0.375 w/ 35 queries
00:23:56 - process[8]: training epoch 19 ...
00:24:06 - process[8] - epoch 19 - train iter 187 - 18282.4 words/s - loss: 0.4472
00:24:06 - process[8]: evaluating epoch 19 on dev ...
00:24:47 - dev set during evaluation: 14980/14975
00:24:47 - process[8] - dev - epoch 19 - mAP: 0.374 w/ 35 queries
00:24:47 - [fold 2] best test MAP: 0.328 @ epoch 10
00:24:47 - Evaluating every 1 epochs ...
00:24:47 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:24:48 - test has 35 queries ...
00:24:48 - Data reading done ...
00:24:49 - adding 9-th encoder to optimizer...
00:24:49 - adding 10-th encoder to optimizer...
00:24:49 - adding 11-th encoder to optimizer...
00:24:50 - process[8]: training epoch 0 ...
00:25:00 - process[8] - epoch 0 - train iter 196 - 16652.8 words/s - loss: 0.6813
00:25:00 - process[8]: training epoch 1 ...
00:25:11 - process[8] - epoch 1 - train iter 196 - 16318.7 words/s - loss: 0.6622
00:25:11 - process[8]: training epoch 2 ...
00:25:21 - process[8] - epoch 2 - train iter 196 - 18002.1 words/s - loss: 0.6284
00:25:21 - process[8]: training epoch 3 ...
00:25:30 - process[8] - epoch 3 - train iter 196 - 19320.7 words/s - loss: 0.5986
00:25:30 - process[8]: training epoch 4 ...
00:25:41 - process[8] - epoch 4 - train iter 196 - 16030.9 words/s - loss: 0.5833
00:25:41 - process[8]: training epoch 5 ...
00:25:51 - process[8] - epoch 5 - train iter 196 - 17144.6 words/s - loss: 0.5662
00:25:51 - process[8]: training epoch 6 ...
00:26:02 - process[8] - epoch 6 - train iter 196 - 16121.5 words/s - loss: 0.6012
00:26:02 - process[8]: training epoch 7 ...
00:26:13 - process[8] - epoch 7 - train iter 196 - 17522.2 words/s - loss: 0.5590
00:26:13 - process[8]: training epoch 8 ...
00:26:23 - process[8] - epoch 8 - train iter 196 - 17421.0 words/s - loss: 0.5273
00:26:23 - process[8]: training epoch 9 ...
00:26:34 - process[8] - epoch 9 - train iter 196 - 16551.1 words/s - loss: 0.5556
00:26:34 - process[8]: training epoch 10 ...
00:26:44 - process[8] - epoch 10 - train iter 196 - 16603.3 words/s - loss: 0.5203
00:26:44 - process[8]: evaluating epoch 10 on dev ...
00:27:32 - dev set during evaluation: 15300/15294
00:27:32 - process[8] - dev - epoch 10 - mAP: 0.273 w/ 36 queries
00:27:32 - process[8]: evaluating epoch 10 on test ...
00:28:15 - test set during evaluation: 15480/15477
00:28:15 - process[8] - test - epoch 10 - mAP: 0.274 w/ 35 queries
00:28:15 - process[8]: training epoch 11 ...
00:28:25 - process[8] - epoch 11 - train iter 196 - 16545.5 words/s - loss: 0.5022
00:28:25 - process[8]: evaluating epoch 11 on dev ...
00:29:08 - dev set during evaluation: 15300/15294
00:29:09 - process[8] - dev - epoch 11 - mAP: 0.298 w/ 36 queries
00:29:09 - process[8]: evaluating epoch 11 on test ...
00:29:51 - test set during evaluation: 15480/15477
00:29:51 - process[8] - test - epoch 11 - mAP: 0.297 w/ 35 queries
00:29:51 - process[8]: training epoch 12 ...
00:30:02 - process[8] - epoch 12 - train iter 196 - 15921.0 words/s - loss: 0.5203
00:30:02 - process[8]: evaluating epoch 12 on dev ...
00:30:44 - dev set during evaluation: 15300/15294
00:30:44 - process[8] - dev - epoch 12 - mAP: 0.309 w/ 36 queries
00:30:44 - process[8]: evaluating epoch 12 on test ...
00:31:26 - test set during evaluation: 15480/15477
00:31:26 - process[8] - test - epoch 12 - mAP: 0.307 w/ 35 queries
00:31:26 - process[8]: training epoch 13 ...
00:31:36 - process[8] - epoch 13 - train iter 196 - 19269.5 words/s - loss: 0.4997
00:31:36 - process[8]: evaluating epoch 13 on dev ...
00:32:21 - dev set during evaluation: 15300/15294
00:32:21 - process[8] - dev - epoch 13 - mAP: 0.331 w/ 36 queries
00:32:21 - process[8]: evaluating epoch 13 on test ...
00:33:03 - test set during evaluation: 15480/15477
00:33:03 - process[8] - test - epoch 13 - mAP: 0.327 w/ 35 queries
00:33:03 - process[8]: training epoch 14 ...
00:33:13 - process[8] - epoch 14 - train iter 196 - 18161.5 words/s - loss: 0.4849
00:33:13 - process[8]: evaluating epoch 14 on dev ...
00:33:57 - dev set during evaluation: 15300/15294
00:33:57 - process[8] - dev - epoch 14 - mAP: 0.331 w/ 36 queries
00:33:57 - process[8]: evaluating epoch 14 on test ...
00:34:39 - test set during evaluation: 15480/15477
00:34:39 - process[8] - test - epoch 14 - mAP: 0.302 w/ 35 queries
00:34:39 - process[8]: training epoch 15 ...
00:34:49 - process[8] - epoch 15 - train iter 196 - 17793.3 words/s - loss: 0.4450
00:34:49 - process[8]: evaluating epoch 15 on dev ...
00:35:32 - dev set during evaluation: 15300/15294
00:35:32 - process[8] - dev - epoch 15 - mAP: 0.301 w/ 36 queries
00:35:32 - process[8]: training epoch 16 ...
00:35:42 - process[8] - epoch 16 - train iter 196 - 16386.4 words/s - loss: 0.4322
00:35:42 - process[8]: evaluating epoch 16 on dev ...
00:36:24 - dev set during evaluation: 15300/15294
00:36:24 - process[8] - dev - epoch 16 - mAP: 0.315 w/ 36 queries
00:36:24 - process[8]: training epoch 17 ...
00:36:34 - process[8] - epoch 17 - train iter 196 - 19141.0 words/s - loss: 0.4877
00:36:34 - process[8]: evaluating epoch 17 on dev ...
00:37:18 - dev set during evaluation: 15300/15294
00:37:18 - process[8] - dev - epoch 17 - mAP: 0.388 w/ 36 queries
00:37:18 - process[8]: evaluating epoch 17 on test ...
00:38:00 - test set during evaluation: 15480/15477
00:38:00 - process[8] - test - epoch 17 - mAP: 0.336 w/ 35 queries
00:38:00 - process[8]: training epoch 18 ...
00:38:10 - process[8] - epoch 18 - train iter 196 - 18194.7 words/s - loss: 0.4855
00:38:10 - process[8]: evaluating epoch 18 on dev ...
00:38:54 - dev set during evaluation: 15300/15294
00:38:54 - process[8] - dev - epoch 18 - mAP: 0.342 w/ 36 queries
00:38:54 - process[8]: training epoch 19 ...
00:39:04 - process[8] - epoch 19 - train iter 196 - 18139.0 words/s - loss: 0.4728
00:39:04 - process[8]: evaluating epoch 19 on dev ...
00:39:48 - dev set during evaluation: 15300/15294
00:39:48 - process[8] - dev - epoch 19 - mAP: 0.336 w/ 36 queries
00:39:48 - [fold 3] best test MAP: 0.336 @ epoch 17
00:39:48 - Evaluating every 1 epochs ...
00:39:48 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:39:48 - test has 35 queries ...
00:39:48 - Data reading done ...
00:39:50 - adding 9-th encoder to optimizer...
00:39:50 - adding 10-th encoder to optimizer...
00:39:50 - adding 11-th encoder to optimizer...
00:39:51 - process[8]: training epoch 0 ...
00:40:02 - process[8] - epoch 0 - train iter 207 - 16467.6 words/s - loss: 0.6829
00:40:02 - process[8]: training epoch 1 ...
00:40:13 - process[8] - epoch 1 - train iter 207 - 17794.4 words/s - loss: 0.6545
00:40:13 - process[8]: training epoch 2 ...
00:40:24 - process[8] - epoch 2 - train iter 207 - 17045.8 words/s - loss: 0.6282
00:40:24 - process[8]: training epoch 3 ...
00:40:37 - process[8] - epoch 3 - train iter 207 - 14513.1 words/s - loss: 0.6032
00:40:37 - process[8]: training epoch 4 ...
00:40:49 - process[8] - epoch 4 - train iter 207 - 15620.5 words/s - loss: 0.5768
00:40:49 - process[8]: training epoch 5 ...
00:40:59 - process[8] - epoch 5 - train iter 207 - 18128.0 words/s - loss: 0.5451
00:40:59 - process[8]: training epoch 6 ...
00:41:10 - process[8] - epoch 6 - train iter 207 - 17150.7 words/s - loss: 0.5369
00:41:10 - process[8]: training epoch 7 ...
00:41:20 - process[8] - epoch 7 - train iter 207 - 18683.5 words/s - loss: 0.5077
00:41:20 - process[8]: training epoch 8 ...
00:41:31 - process[8] - epoch 8 - train iter 207 - 17075.0 words/s - loss: 0.4865
00:41:31 - process[8]: training epoch 9 ...
00:41:42 - process[8] - epoch 9 - train iter 207 - 17192.2 words/s - loss: 0.4984
00:41:42 - process[8]: training epoch 10 ...
00:41:53 - process[8] - epoch 10 - train iter 207 - 16544.6 words/s - loss: 0.5169
00:41:53 - process[8]: evaluating epoch 10 on dev ...
00:42:40 - dev set during evaluation: 15480/15477
00:42:40 - process[8] - dev - epoch 10 - mAP: 0.290 w/ 35 queries
00:42:40 - process[8]: evaluating epoch 10 on test ...
00:43:23 - test set during evaluation: 14470/14463
00:43:23 - process[8] - test - epoch 10 - mAP: 0.263 w/ 35 queries
00:43:23 - process[8]: training epoch 11 ...
00:43:33 - process[8] - epoch 11 - train iter 207 - 18213.7 words/s - loss: 0.4957
00:43:33 - process[8]: evaluating epoch 11 on dev ...
00:44:16 - dev set during evaluation: 15480/15477
00:44:16 - process[8] - dev - epoch 11 - mAP: 0.291 w/ 35 queries
00:44:16 - process[8]: evaluating epoch 11 on test ...
00:44:58 - test set during evaluation: 14470/14463
00:44:58 - process[8] - test - epoch 11 - mAP: 0.292 w/ 35 queries
00:44:58 - process[8]: training epoch 12 ...
00:45:10 - process[8] - epoch 12 - train iter 207 - 15943.2 words/s - loss: 0.4615
00:45:10 - process[8]: evaluating epoch 12 on dev ...
00:45:52 - dev set during evaluation: 15480/15477
00:45:52 - process[8] - dev - epoch 12 - mAP: 0.265 w/ 35 queries
00:45:52 - process[8]: training epoch 13 ...
00:46:03 - process[8] - epoch 13 - train iter 207 - 16791.3 words/s - loss: 0.4620
00:46:03 - process[8]: evaluating epoch 13 on dev ...
00:46:45 - dev set during evaluation: 15480/15477
00:46:45 - process[8] - dev - epoch 13 - mAP: 0.281 w/ 35 queries
00:46:45 - process[8]: training epoch 14 ...
00:46:56 - process[8] - epoch 14 - train iter 207 - 17289.7 words/s - loss: 0.4511
00:46:56 - process[8]: evaluating epoch 14 on dev ...
00:47:39 - dev set during evaluation: 15480/15477
00:47:39 - process[8] - dev - epoch 14 - mAP: 0.293 w/ 35 queries
00:47:39 - process[8]: evaluating epoch 14 on test ...
00:48:21 - test set during evaluation: 14470/14463
00:48:21 - process[8] - test - epoch 14 - mAP: 0.314 w/ 35 queries
00:48:21 - process[8]: training epoch 15 ...
00:48:32 - process[8] - epoch 15 - train iter 207 - 17009.6 words/s - loss: 0.4260
00:48:32 - process[8]: evaluating epoch 15 on dev ...
00:49:14 - dev set during evaluation: 15480/15477
00:49:14 - process[8] - dev - epoch 15 - mAP: 0.280 w/ 35 queries
00:49:14 - process[8]: training epoch 16 ...
00:49:25 - process[8] - epoch 16 - train iter 207 - 15840.9 words/s - loss: 0.4368
00:49:25 - process[8]: evaluating epoch 16 on dev ...
00:50:07 - dev set during evaluation: 15480/15477
00:50:07 - process[8] - dev - epoch 16 - mAP: 0.283 w/ 35 queries
00:50:07 - process[8]: training epoch 17 ...
00:50:19 - process[8] - epoch 17 - train iter 207 - 15910.4 words/s - loss: 0.4059
00:50:19 - process[8]: evaluating epoch 17 on dev ...
00:51:01 - dev set during evaluation: 15480/15477
00:51:01 - process[8] - dev - epoch 17 - mAP: 0.331 w/ 35 queries
00:51:01 - process[8]: evaluating epoch 17 on test ...
00:51:44 - test set during evaluation: 14470/14463
00:51:44 - process[8] - test - epoch 17 - mAP: 0.323 w/ 35 queries
00:51:44 - process[8]: training epoch 18 ...
00:51:54 - process[8] - epoch 18 - train iter 207 - 17484.2 words/s - loss: 0.4747
00:51:54 - process[8]: evaluating epoch 18 on dev ...
00:52:37 - dev set during evaluation: 15480/15477
00:52:37 - process[8] - dev - epoch 18 - mAP: 0.323 w/ 35 queries
00:52:37 - process[8]: training epoch 19 ...
00:52:47 - process[8] - epoch 19 - train iter 207 - 19004.9 words/s - loss: 0.4314
00:52:47 - process[8]: evaluating epoch 19 on dev ...
00:53:30 - dev set during evaluation: 15480/15477
00:53:30 - process[8] - dev - epoch 19 - mAP: 0.312 w/ 35 queries
00:53:30 - [fold 4] best test MAP: 0.323 @ epoch 17
00:53:30 - Evaluating every 1 epochs ...
00:53:30 - reading data from /mnt/home/puxuan/CLIR-project/Evaluation_data/process-clef/uncased
00:53:31 - test has 35 queries ...
00:53:31 - Data reading done ...
00:53:33 - adding 9-th encoder to optimizer...
00:53:33 - adding 10-th encoder to optimizer...
00:53:33 - adding 11-th encoder to optimizer...
00:53:33 - process[8]: training epoch 0 ...
00:53:44 - process[8] - epoch 0 - train iter 195 - 15966.2 words/s - loss: 0.6837
00:53:44 - process[8]: training epoch 1 ...
00:53:56 - process[8] - epoch 1 - train iter 195 - 15190.9 words/s - loss: 0.6436
00:53:56 - process[8]: training epoch 2 ...
00:54:07 - process[8] - epoch 2 - train iter 195 - 15679.0 words/s - loss: 0.5846
00:54:07 - process[8]: training epoch 3 ...
00:54:18 - process[8] - epoch 3 - train iter 195 - 15636.1 words/s - loss: 0.5962
00:54:18 - process[8]: training epoch 4 ...
00:54:30 - process[8] - epoch 4 - train iter 195 - 15286.4 words/s - loss: 0.5719
00:54:30 - process[8]: training epoch 5 ...
00:54:42 - process[8] - epoch 5 - train iter 195 - 14385.3 words/s - loss: 0.5173
00:54:42 - process[8]: training epoch 6 ...
00:54:53 - process[8] - epoch 6 - train iter 195 - 15733.6 words/s - loss: 0.5021
00:54:53 - process[8]: training epoch 7 ...
00:55:04 - process[8] - epoch 7 - train iter 195 - 15886.3 words/s - loss: 0.5093
00:55:04 - process[8]: training epoch 8 ...
00:55:15 - process[8] - epoch 8 - train iter 195 - 15350.5 words/s - loss: 0.4485
00:55:15 - process[8]: training epoch 9 ...
00:55:25 - process[8] - epoch 9 - train iter 195 - 18124.3 words/s - loss: 0.4883
00:55:25 - process[8]: training epoch 10 ...
00:55:36 - process[8] - epoch 10 - train iter 195 - 15725.8 words/s - loss: 0.4746
00:55:36 - process[8]: evaluating epoch 10 on dev ...
00:56:18 - dev set during evaluation: 14470/14463
00:56:18 - process[8] - dev - epoch 10 - mAP: 0.295 w/ 35 queries
00:56:18 - process[8]: evaluating epoch 10 on test ...
00:57:04 - test set during evaluation: 14160/14157
00:57:04 - process[8] - test - epoch 10 - mAP: 0.323 w/ 35 queries
00:57:04 - process[8]: training epoch 11 ...
00:57:14 - process[8] - epoch 11 - train iter 195 - 16469.6 words/s - loss: 0.4781
00:57:14 - process[8]: evaluating epoch 11 on dev ...
00:57:59 - dev set during evaluation: 14470/14463
00:57:59 - process[8] - dev - epoch 11 - mAP: 0.285 w/ 35 queries
00:57:59 - process[8]: training epoch 12 ...
00:58:09 - process[8] - epoch 12 - train iter 195 - 16161.9 words/s - loss: 0.4227
00:58:09 - process[8]: evaluating epoch 12 on dev ...
00:58:51 - dev set during evaluation: 14470/14463
00:58:51 - process[8] - dev - epoch 12 - mAP: 0.318 w/ 35 queries
00:58:51 - process[8]: evaluating epoch 12 on test ...
00:59:37 - test set during evaluation: 14160/14157
00:59:37 - process[8] - test - epoch 12 - mAP: 0.351 w/ 35 queries
00:59:37 - process[8]: training epoch 13 ...
00:59:48 - process[8] - epoch 13 - train iter 195 - 16083.3 words/s - loss: 0.4677
00:59:48 - process[8]: evaluating epoch 13 on dev ...
01:00:30 - dev set during evaluation: 14470/14463
01:00:30 - process[8] - dev - epoch 13 - mAP: 0.336 w/ 35 queries
01:00:30 - process[8]: evaluating epoch 13 on test ...
01:01:16 - test set during evaluation: 14160/14157
01:01:16 - process[8] - test - epoch 13 - mAP: 0.359 w/ 35 queries
01:01:16 - process[8]: training epoch 14 ...
01:01:27 - process[8] - epoch 14 - train iter 195 - 15690.1 words/s - loss: 0.4661
01:01:27 - process[8]: evaluating epoch 14 on dev ...
01:02:10 - dev set during evaluation: 14470/14463
01:02:10 - process[8] - dev - epoch 14 - mAP: 0.339 w/ 35 queries
01:02:10 - process[8]: evaluating epoch 14 on test ...
01:02:55 - test set during evaluation: 14160/14157
01:02:55 - process[8] - test - epoch 14 - mAP: 0.342 w/ 35 queries
01:02:55 - process[8]: training epoch 15 ...
01:03:06 - process[8] - epoch 15 - train iter 195 - 16529.4 words/s - loss: 0.4214
01:03:06 - process[8]: evaluating epoch 15 on dev ...
01:03:48 - dev set during evaluation: 14470/14463
01:03:48 - process[8] - dev - epoch 15 - mAP: 0.311 w/ 35 queries
01:03:48 - process[8]: training epoch 16 ...
01:03:59 - process[8] - epoch 16 - train iter 195 - 16302.7 words/s - loss: 0.4574
01:03:59 - process[8]: evaluating epoch 16 on dev ...
01:04:43 - dev set during evaluation: 14470/14463
01:04:43 - process[8] - dev - epoch 16 - mAP: 0.296 w/ 35 queries
01:04:43 - process[8]: training epoch 17 ...
01:04:53 - process[8] - epoch 17 - train iter 195 - 16908.6 words/s - loss: 0.3860
01:04:53 - process[8]: evaluating epoch 17 on dev ...
01:05:37 - dev set during evaluation: 14470/14463
01:05:37 - process[8] - dev - epoch 17 - mAP: 0.342 w/ 35 queries
01:05:37 - process[8]: evaluating epoch 17 on test ...
01:06:22 - test set during evaluation: 14160/14157
01:06:22 - process[8] - test - epoch 17 - mAP: 0.352 w/ 35 queries
01:06:22 - process[8]: training epoch 18 ...
01:06:34 - process[8] - epoch 18 - train iter 195 - 14574.8 words/s - loss: 0.4231
01:06:34 - process[8]: evaluating epoch 18 on dev ...
01:07:14 - dev set during evaluation: 14470/14463
01:07:14 - process[8] - dev - epoch 18 - mAP: 0.348 w/ 35 queries
01:07:14 - process[8]: evaluating epoch 18 on test ...
01:08:00 - test set during evaluation: 14160/14157
01:08:00 - process[8] - test - epoch 18 - mAP: 0.348 w/ 35 queries
01:08:00 - process[8]: training epoch 19 ...
01:08:10 - process[8] - epoch 19 - train iter 195 - 18245.8 words/s - loss: 0.4116
01:08:10 - process[8]: evaluating epoch 19 on dev ...
01:08:53 - dev set during evaluation: 14470/14463
01:08:53 - process[8] - dev - epoch 19 - mAP: 0.306 w/ 35 queries
01:08:54 - [fold 5] best test MAP: 0.348 @ epoch 18
01:08:54 - [0.3827829013885834, 0.3277149519253127, 0.33600581380736017, 0.3231640701663685, 0.34844428784499326]
01:08:54 - [35, 36, 35, 35, 35]
01:08:54 - final MAP: 0.344
